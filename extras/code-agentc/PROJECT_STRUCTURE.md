# Code-AgentC é¡¹ç›®ç»“æ„æ¦‚è§ˆ

## ç›®å½•ç»“æ„

```
examples/code-agentc/
â”œâ”€â”€ README.md              # é¡¹ç›®è¯´æ˜æ–‡æ¡£
â”œâ”€â”€ CMakeLists.txt         # CMake æ„å»ºé…ç½®
â”œâ”€â”€ .gitignore            # Git å¿½ç•¥æ–‡ä»¶é…ç½®
â”œâ”€â”€ env.example           # ç¯å¢ƒå˜é‡é…ç½®ç¤ºä¾‹
â”œâ”€â”€ main.c                # ä¸»ç¨‹åºå…¥å£ï¼ˆçº¦ 200 è¡Œï¼‰
â”‚
â”œâ”€â”€ include/              # å¤´æ–‡ä»¶ç›®å½•
â”‚   â”œâ”€â”€ code_agentc.h    # ä¸»åº”ç”¨å¤´æ–‡ä»¶
â”‚   â”œâ”€â”€ rules.h          # Rules ç³»ç»Ÿå¤´æ–‡ä»¶
â”‚   â”œâ”€â”€ skills.h         # Skills ç³»ç»Ÿå¤´æ–‡ä»¶
â”‚   â”œâ”€â”€ mcp_client.h     # MCP å®¢æˆ·ç«¯å¤´æ–‡ä»¶
â”‚   â””â”€â”€ tools.h          # å·¥å…·å®šä¹‰å¤´æ–‡ä»¶
â”‚
â”œâ”€â”€ core/                 # æ ¸å¿ƒé€»è¾‘å®ç°
â”‚   â”œâ”€â”€ code_agentc.c    # ä¸»åº”ç”¨å®ç°ï¼ˆçº¦ 300 è¡Œï¼‰
â”‚   â”œâ”€â”€ rules.c          # Rules ç®¡ç†å™¨å®ç°ï¼ˆçº¦ 250 è¡Œï¼‰
â”‚   â”œâ”€â”€ skills.c         # Skills ç®¡ç†å™¨å®ç°ï¼ˆçº¦ 200 è¡Œï¼‰
â”‚   â””â”€â”€ mcp_client.c     # MCP å®¢æˆ·ç«¯å®ç°ï¼ˆçº¦ 150 è¡Œï¼Œå¾…å®Œå–„ï¼‰
â”‚
â”œâ”€â”€ tools/                # å·¥å…·é›†å®ç°
â”‚   â”œâ”€â”€ tools.c          # å·¥å…·æ³¨å†Œå…¥å£ï¼ˆçº¦ 50 è¡Œï¼‰
â”‚   â””â”€â”€ file_tools.c     # æ–‡ä»¶æ“ä½œå·¥å…·ï¼ˆçº¦ 200 è¡Œï¼‰
â”‚
â””â”€â”€ ui/                   # ç”¨æˆ·ç•Œé¢ï¼ˆå¾…å®ç°ï¼‰
    â”œâ”€â”€ tui.c            # ç»ˆç«¯ UI ç»„ä»¶
    â””â”€â”€ progress.c       # è¿›åº¦æ˜¾ç¤ºç»„ä»¶
```

## å·²å®Œæˆçš„åŠŸèƒ½

### âœ… æ ¸å¿ƒæ¡†æ¶
- **ä¸»åº”ç”¨ç»“æ„** (`code_agentc.c`): 
  - é›†æˆ agentc çš„ LLMã€Toolsã€Memoryã€Agent ç»„ä»¶
  - åˆå§‹åŒ–æµç¨‹å®Œæ•´
  - æ”¯æŒåŒæ­¥å’Œäº¤äº’æ¨¡å¼ï¼ˆäº¤äº’æ¨¡å¼å¾…å®ç°ï¼‰

- **å‘½ä»¤è¡Œæ¥å£** (`main.c`):
  - å®Œæ•´çš„å‚æ•°è§£æ
  - æ”¯æŒç¯å¢ƒå˜é‡é…ç½®
  - å¸®åŠ©ä¿¡æ¯å’Œç‰ˆæœ¬ä¿¡æ¯

### âœ… Rules ç³»ç»Ÿ
- **Rules ç®¡ç†å™¨** (`core/rules.c`):
  - ä»ç›®å½•åŠ è½½ YAML è§„åˆ™æ–‡ä»¶
  - æ”¯æŒè§„åˆ™ä¼˜å…ˆçº§æ’åº
  - è‡ªåŠ¨æ„å»ºç³»ç»Ÿæç¤º
  - å®Œå…¨æ— éœ€ä¾µå…¥ agentc

**å·¥ä½œåŸç†**:
```c
// 1. åŠ è½½è§„åˆ™
code_agentc_rules_load(rules, ".code-agentc/rules");

// 2. æ„å»ºç³»ç»Ÿæç¤º
char* prompt = code_agentc_rules_build_prompt(rules, base_prompt);

// 3. æ³¨å…¥åˆ° LLM
ac_llm_create(&(ac_llm_params_t){
    .instructions = prompt,  // â† è§„åˆ™åœ¨è¿™é‡Œç”Ÿæ•ˆ
    ...
});
```

### âœ… Skills ç³»ç»Ÿ
- **Skills ç®¡ç†å™¨** (`core/skills.c`):
  - åŸºç¡€æ¡†æ¶å®Œæˆ
  - æ”¯æŒæŠ€èƒ½å¯ç”¨/ç¦ç”¨
  - å¾…å®ç°ï¼šä» YAML åŠ è½½ã€å·¥å…·æ³¨å†Œ

### âœ… å·¥å…·ç³»ç»Ÿ
- **æ–‡ä»¶æ“ä½œå·¥å…·** (`tools/file_tools.c`):
  - `read_file`: è¯»å–æ–‡ä»¶å†…å®¹
  - `write_file`: å†™å…¥æ–‡ä»¶
  - `list_directory`: åˆ—å‡ºç›®å½•
  - å®Œæ•´çš„ JSON å‚æ•°è§£æ
  - é”™è¯¯å¤„ç†

**å·¥å…·æ³¨å†Œç¤ºä¾‹**:
```c
ac_tool_register(tools, &(ac_tool_t){
    .name = "read_file",
    .description = "Read the contents of a file",
    .parameters = params,
    .handler = tool_read_file,
    .tools_group = "file_operations",
});
```

### âš ï¸ å¾…å®ç°çš„åŠŸèƒ½

1. **MCP å®¢æˆ·ç«¯** (`core/mcp_client.c`):
   - æ¡†æ¶å·²æ­å»º
   - éœ€è¦å®ç°ï¼šHTTP é€šä¿¡ã€JSON-RPC åè®®ã€å·¥å…·å‘ç°

2. **äº¤äº’æ¨¡å¼** (`main.c`):
   - éœ€è¦å®ç° REPL å¾ªç¯
   - æµå¼è¾“å‡ºå¤„ç†
   - å‘½ä»¤å¤„ç†ï¼ˆ/help, /exit, /clear ç­‰ï¼‰

3. **æ›´å¤šå·¥å…·**:
   - Search tools (grep, find)
   - Shell tools (execute_command)
   - Git tools (status, diff, commit)

4. **ç»ˆç«¯ UI** (`ui/`):
   - TUI ç»„ä»¶
   - è¿›åº¦æ˜¾ç¤º
   - Markdown æ¸²æŸ“é›†æˆ

## æ ¸å¿ƒè®¾è®¡ç†å¿µ

### ğŸ¯ å®Œå…¨åŸºäº agentcï¼Œé›¶ä¾µå…¥

ä»£ç æ¼”ç¤ºäº†å¦‚ä½•**å®Œå…¨ä¸ä¿®æ”¹ agentc** çš„æƒ…å†µä¸‹å®ç°å¤æ‚åŠŸèƒ½ï¼š

1. **Rules**: é€šè¿‡ `instructions` å‚æ•°æ³¨å…¥
2. **Skills**: é€šè¿‡åŠ¨æ€å·¥å…·æ³¨å†Œå®ç°
3. **MCP**: é€šè¿‡ `user_data` å’Œå·¥å…·åŒ…è£…å™¨å®ç°
4. **è‡ªå®šä¹‰å·¥å…·**: å®ç° `ac_tool_handler_t` æ¥å£

### ğŸ”§ agentc æä¾›çš„å…³é”®èƒ½åŠ›

```c
// 1. çµæ´»çš„ LLM é…ç½®
ac_llm_create(&(ac_llm_params_t){
    .instructions = custom_system_prompt,  // â† Rules æ³¨å…¥ç‚¹
    ...
});

// 2. å¼ºå¤§çš„å·¥å…·ç³»ç»Ÿ
ac_tool_register(tools, &(ac_tool_t){
    .handler = custom_handler,
    .user_data = custom_context,  // â† å¯ä»¥ä¼ é€’ä»»ä½•ä¸Šä¸‹æ–‡
    ...
});

// 3. å®Œæ•´çš„ Agent æµç¨‹
ac_agent_create(&(ac_agent_params_t){
    .llm = llm,
    .tools = tools,      // â† åŒ…å«æ‰€æœ‰å·¥å…·ï¼ˆå†…ç½®+MCP+è‡ªå®šä¹‰ï¼‰
    .memory = memory,
    ...
});
```

## æ„å»ºå’Œè¿è¡Œ

### æ„å»º
```bash
cd examples/code-agentc
cmake -B build
cmake --build build
```

### é…ç½®
```bash
cp env.example .env
# ç¼–è¾‘ .env å¡«å…¥ API Key
```

### è¿è¡Œ
```bash
# ä¸€æ¬¡æ€§æ¨¡å¼
./build/code-agentc "Create a hello world program in C"

# äº¤äº’æ¨¡å¼ï¼ˆå¾…å®ç°ï¼‰
./build/code-agentc -i

# æŒ‡å®šæ¨¡å‹
./build/code-agentc -m deepseek-chat "Refactor this code"
```

## å¼€å‘è®¡åˆ’

### ç¬¬ä¸€é˜¶æ®µï¼ˆå½“å‰ï¼‰
- âœ… åŸºç¡€æ¡†æ¶
- âœ… Rules ç³»ç»Ÿ
- âœ… åŸºç¡€æ–‡ä»¶å·¥å…·
- âœ… å‘½ä»¤è¡Œæ¥å£

### ç¬¬äºŒé˜¶æ®µ
- â³ å®Œå–„äº¤äº’æ¨¡å¼
- â³ æ›´å¤šå·¥å…·å®ç°
- â³ Skills å®Œæ•´å®ç°
- â³ ç»ˆç«¯ UI

### ç¬¬ä¸‰é˜¶æ®µ
- â³ MCP åè®®å®ç°
- â³ Git é›†æˆ
- â³ é¡¹ç›®ä¸Šä¸‹æ–‡åˆ†æ
- â³ ä»£ç æœç´¢ä¼˜åŒ–

## é¢„ä¼°ä»£ç é‡

| ç»„ä»¶ | å½“å‰è¡Œæ•° | ç›®æ ‡è¡Œæ•° | çŠ¶æ€ |
|------|---------|---------|------|
| æ ¸å¿ƒæ¡†æ¶ | ~900 | ~1000 | âœ… 90% |
| Rules | ~250 | ~300 | âœ… 80% |
| Skills | ~150 | ~400 | âš ï¸ 40% |
| MCP | ~100 | ~1000 | âš ï¸ 10% |
| å·¥å…·é›† | ~250 | ~1500 | âš ï¸ 15% |
| UI | 0 | ~650 | âŒ 0% |
| **æ€»è®¡** | ~1650 | ~4850 | âš ï¸ 34% |

## æ€»ç»“

è¿™ä¸ªé¡¹ç›®ç»“æ„å®Œç¾å±•ç¤ºäº†ï¼š

1. âœ… **agentc èƒ½åŠ›å……è¶³**: æ— éœ€ä¿®æ”¹æ ¸å¿ƒæ¡†æ¶
2. âœ… **è®¾è®¡æ¸…æ™°**: èŒè´£åˆ†ç¦»ï¼Œæ˜“äºç»´æŠ¤
3. âœ… **æ‰©å±•æ€§å¼º**: å¯ä»¥è½»æ¾æ·»åŠ æ–°å·¥å…·ã€æ–°æŠ€èƒ½
4. âœ… **å¯ç§»æ¤æ€§å¥½**: åŸºäºæ ‡å‡† C99 å’Œ POSIX

**å…³é”®ç»“è®º**: agentc çš„è®¾è®¡ç†å¿µï¼ˆå·¥å…·ç³»ç»Ÿã€å‚æ•°çµæ´»æ€§ã€åˆ†å±‚æ¶æ„ï¼‰ä½¿å¾—å®ƒå®Œå…¨èƒ½å¤Ÿæ”¯æ’‘å¤æ‚çš„åº”ç”¨åœºæ™¯ï¼Œæ— éœ€ä»»ä½•ä¾µå…¥å¼ä¿®æ”¹ã€‚
